<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>WebAR: 3D –ê—Å—Ç—Ä–æ–Ω–∞–≤—Ç –Ω–∞ –º–∞—Ä–∫–µ—Ä–µ</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ A-Frame –∏–∑ CDN -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ AR.js (—Å–±–æ—Ä–∫–∞ –¥–ª—è A-Frame) -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ -->
    <script src="js/app.js" defer></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöÄ</text></svg>">
</head>
<body>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div id="app">
        
        <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç—É—Å–∞ -->
        <div id="status-panel" class="panel">
            <p id="status-message">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ AR...</p>
            <div id="permission-hint" class="hidden">
                <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∏—Ç –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–µ–π –∫–∞–º–µ—Ä–µ. –ù–∞–∂–º–∏—Ç–µ "–†–∞–∑—Ä–µ—à–∏—Ç—å".</p>
                <button id="start-button">–ù–∞—á–∞—Ç—å AR-–æ–ø—ã—Ç</button>
            </div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è AR-—Å—Ü–µ–Ω—ã -->
        <div id="ar-container" class="hidden">
            <a-scene 
                embedded 
                vr-mode-ui="enabled: false" 
                arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
                renderer="logarithmicDepthBuffer: true; antialias: true; precision: medium;"
                device-orientation-permission-ui="enabled: false">

                <!-- –ú–∞—Ä–∫–µ—Ä (–ø–∞—Ç—Ç–µ—Ä–Ω) -->
                <a-marker 
                    id="main-marker"
                    type="pattern" 
                    url="assets/markers/pattern-marker.patt"
                    smooth="true" 
                    smoothCount="5" 
                    smoothTolerance="0.01"
                    emitevents="true">
                    
                    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è 3D-–º–æ–¥–µ–ª–∏ -->
                    <a-entity 
                        id="model-container"
                        position="0 0.15 0"
                        scale="0.25 0.25 0.25"
                        rotation="0 0 0">
                        <!-- 3D-–º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ JS -->
                    </a-entity>

                    <!-- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
                    <a-ring 
                        color="teal" 
                        radius-inner="0.04" 
                        radius-outer="0.05" 
                        rotation="-90 0 0">
                    </a-ring>

                </a-marker>

                <!-- –ö–∞–º–µ—Ä–∞ —Å—Ü–µ–Ω—ã -->
                <a-entity camera></a-entity>
            </a-scene>

            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª—å—é -->
            <div id="controls-panel" class="panel hidden">
                <div class="controls-grid">
                    <button class="control-btn" data-action="rotate-left" title="–ü–æ–≤–µ—Ä–Ω—É—Ç—å –≤–ª–µ–≤–æ">
                        ‚Ü∂
                    </button>
                    <button class="control-btn" data-action="scale-up" title="–£–≤–µ–ª–∏—á–∏—Ç—å">
                        <span class="icon">+</span>
                    </button>
                    <button class="control-btn" data-action="scale-down" title="–£–º–µ–Ω—å—à–∏—Ç—å">
                        <span class="icon">‚àí</span>
                    </button>
                    <button class="control-btn" data-action="rotate-right" title="–ü–æ–≤–µ—Ä–Ω—É—Ç—å –≤–ø—Ä–∞–≤–æ">
                        ‚Ü∑
                    </button>
                    <button class="control-btn wide" data-action="reset" title="–°–±—Ä–æ—Å–∏—Ç—å">
                        –°–±—Ä–æ—Å
                    </button>
                </div>
            </div>

            <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div id="instruction" class="panel">
                <p>–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä</p>
                <div class="marker-preview">
                    <img src="assets/markers/marker-image.png" alt="–ú–∞—Ä–∫–µ—Ä">
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –æ—à–∏–±–∫–∏ -->
        <div id="error-panel" class="panel hidden">
            <h3>‚ö†Ô∏è –û—à–∏–±–∫–∞</h3>
            <p id="error-message"></p>
            <button id="retry-button">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>

    </div>

    <!-- –°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ -->
    <script>
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è iOS - —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–º–µ—Ä—ã
        document.getElementById('start-button').addEventListener('click', function() {
            document.getElementById('permission-hint').classList.add('hidden');
            document.getElementById('status-message').textContent = "–ó–∞–ø—É—Å–∫ –∫–∞–º–µ—Ä—ã...";
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –ª—É—á—à–µ–≥–æ UX
            setTimeout(() => {
                document.getElementById('ar-container').classList.remove('hidden');
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AR —Å—Ü–µ–Ω—ã –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
            }, 500);
        });
    </script>
</body>
</html>