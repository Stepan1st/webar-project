<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WebAR –†–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è</title>
    
    <!-- –¢–û–õ–¨–ö–û —ç—Ç–∏ –¥–≤–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@master/aframe/build/aframe-ar.js"></script>
    
    <style>
        /* –ê–ë–°–û–õ–Æ–¢–ù–û –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: black;
        }
        
        #ar-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }
        
        #ar-container a-scene {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        #controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(0,0,0,0.7);
            color: white;
            border: 2px solid white;
            font-size: 24px;
            cursor: pointer;
        }
        
        .hidden {
            display: none;
        }
        
        #status {
            position: fixed;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 10px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <!-- –°—Ç–∞—Ç—É—Å -->
    <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div id="ar-container" class="hidden">
        <!-- –ü–†–û–°–¢–ê–Ø AR –°–¶–ï–ù–ê -->
        <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
            <!-- –ú–∞—Ä–∫–µ—Ä Hiro -->
            <a-marker id="main-marker" preset="hiro" emitevents="true">
                <!-- –ü–†–û–°–¢–û–ô –ö–£–ë -->
                <a-box 
                    id="model-container"
                    color="red"
                    position="0 0.5 0"
                    scale="0.5 0.5 0.5"
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 5000">
                </a-box>
            </a-marker>
            
            <a-entity camera></a-entity>
        </a-scene>
        
        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
        <div id="controls" class="hidden">
            <button class="control-btn" onclick="rotateModel(-45)">‚Ü∂</button>
            <button class="control-btn" onclick="rotateModel(45)">‚Ü∑</button>
            <button class="control-btn" onclick="resetModel()">‚ü≥</button>
        </div>
    </div>
    
    <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="start-screen" style="position:fixed; top:0; left:0; width:100%; height:100%; background:black; color:white; display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:2000;">
        <h1>üéØ WebAR –î–µ–º–æ</h1>
        <p style="margin:20px; text-align:center;">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä Hiro</p>
        <button id="start-btn" style="padding:15px 30px; font-size:18px; background:#2196F3; color:white; border:none; border-radius:25px; cursor:pointer;">
            üöÄ –ù–∞—á–∞—Ç—å
        </button>
        <div style="margin-top:30px;">
            <img src="https://raw.githubusercontent.com/AR-js-org/AR.js/master/data/images/hiro.png" 
                 style="width:150px; border:3px solid white; border-radius:10px;">
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let model = null;
        let marker = null;
        
        // –°—Ç–∞—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.getElementById('start-btn').addEventListener('click', function() {
            console.log('üöÄ –ó–∞–ø—É—Å–∫ AR...');
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('ar-container').classList.remove('hidden');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–∞–º–µ—Ä—É (–¥–ª—è iOS)
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia({ video: true })
                    .then(stream => {
                        console.log('‚úÖ –ö–∞–º–µ—Ä–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞');
                        updateStatus('–ö–∞–º–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç! –ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ –º–∞—Ä–∫–µ—Ä');
                    })
                    .catch(error => {
                        console.warn('‚ö†Ô∏è –ö–∞–º–µ—Ä–∞:', error.message);
                        updateStatus('–ö–∞–º–µ—Ä–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: ' + error.message);
                    });
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            setTimeout(setupAR, 1000);
        });
        
        function setupAR() {
            console.log('‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AR...');
            
            // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç—ã
            model = document.getElementById('model-container');
            marker = document.getElementById('main-marker');
            
            console.log('–ú–æ–¥–µ–ª—å:', model);
            console.log('–ú–∞—Ä–∫–µ—Ä:', marker);
            
            if (!model) {
                console.error('‚ùå –ú–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                updateStatus('–û—à–∏–±–∫–∞: –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                return;
            }
            
            // –°–æ–±—ã—Ç–∏—è –º–∞—Ä–∫–µ—Ä–∞
            if (marker) {
                marker.addEventListener('markerFound', function() {
                    console.log('üéØ –ú–∞—Ä–∫–µ—Ä –Ω–∞–π–¥–µ–Ω!');
                    updateStatus('–ú–∞—Ä–∫–µ—Ä –Ω–∞–π–¥–µ–Ω!');
                    document.getElementById('controls').classList.remove('hidden');
                    
                    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –º–æ–¥–µ–ª–∏
                    model.setAttribute('color', 'green');
                    setTimeout(() => model.setAttribute('color', 'red'), 500);
                });
                
                marker.addEventListener('markerLost', function() {
                    console.log('‚ö†Ô∏è –ú–∞—Ä–∫–µ—Ä –ø–æ—Ç–µ—Ä—è–Ω');
                    updateStatus('–ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ –º–∞—Ä–∫–µ—Ä');
                    document.getElementById('controls').classList.add('hidden');
                });
            }
            
            updateStatus('–ì–æ—Ç–æ–≤–æ! –ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ –º–∞—Ä–∫–µ—Ä');
        }
        
        function rotateModel(angle) {
            if (!model) return;
            
            const rotation = model.getAttribute('rotation') || {x:0, y:0, z:0};
            model.setAttribute('rotation', {
                x: rotation.x,
                y: rotation.y + angle,
                z: rotation.z
            });
            
            console.log('–ü–æ–≤–æ—Ä–æ—Ç:', angle, '–≥—Ä–∞–¥—É—Å–æ–≤');
        }
        
        function resetModel() {
            if (!model) return;
            
            model.setAttribute('rotation', {x:0, y:0, z:0});
            model.setAttribute('scale', '0.5 0.5 0.5');
            console.log('–°–±—Ä–æ—Å –º–æ–¥–µ–ª–∏');
        }
        
        function updateStatus(message) {
            document.getElementById('status').textContent = message;
            console.log('üì¢ –°—Ç–∞—Ç—É—Å:', message);
        }
        
        // –ê–≤—Ç–æ—Å—Ç–∞—Ä—Ç –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ (–Ω–µ –¥–ª—è iOS)
        if (!/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
            setTimeout(() => {
                console.log('üñ•Ô∏è –ê–≤—Ç–æ—Å—Ç–∞—Ä—Ç –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞');
                document.getElementById('start-btn').click();
            }, 1000);
        }
    </script>
</body>
</html>